# render.yaml — FULLY WORKING FOR YOUR TAKE-HOME
services:
  
  # ——— BACKEND: NestJS + better-auth ———
  - type: web
    name: acme-backend
    env: node
    region: frankfurt
    plan: free
    buildCommand: |
      
      cd backend
      npm install
      npm run build
    startCommand: cd backend && npm run start:prod
    healthCheckPath: /health
    envVars:
      - key: DATABASE_URL
        generateValue: true  # Set in dashboard (secret)
      - key: NODE_ENV
        generateValue: true 
      - key: NEXT_PUBLIC_APP_URL
        generateValue: true 
      - key: SMTP_USER
        generateValue: true 
      - key: SMTP_PASS
        generateValue: true   # ← Set your 16-digit Gmail App Password in Render Dashboard (secret)
      - key: PORT
        generateValue: true 

  # ——— FRONTEND: Next.js App Router ———
  - type: web
    name: acme-takehome
    env: node
    region: frankfurt
    plan: free
    buildCommand: |
      cd frontend
      npm install
      npm run build
    startCommand: cd frontend && npm run start
    envVars:
       - key: NODE_ENV
         generateValue: true 
       - key: NEXT_PUBLIC_APP_URL
         generateValue: true 
      # This tells better-auth client where to find the backend
       - key: NEXT_PUBLIC_BETTER_AUTH_URL
         generateValue: true 

 